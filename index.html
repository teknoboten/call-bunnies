<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jackrabbit Class Getter</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body
    class="bg-gradient-to-br from-gray-100 to-gray-300 min-h-screen flex flex-col items-center justify-center p-4"
  >
    <div class="max-w-4xl w-full bg-white shadow-2xl rounded-3xl p-10 mb-8">
      <h1 class="text-4xl font-extrabold mb-8 text-gray-800 text-center">
        Jackrabbit Class Getter
      </h1>

      <!-- Class Type Selection -->
      <h2 class="text-2xl font-semibold mb-4">
        What are you looking for today?
      </h2>
      <div class="flex flex-wrap gap-4 mb-8" id="classTypeButtons">
        <button
          class="btn px-6 py-2 rounded-xl font-semibold transition duration-300 bg-indigo-600 text-white"
          id="allClasses"
          data-type=""
        >
          All Classes
        </button>
        <button
          class="btn px-6 py-2 rounded-xl font-semibold transition duration-300 bg-gray-300 text-gray-700"
          id="camps"
          data-type="Camps"
        >
          Camps
        </button>
        <button
          class="btn px-6 py-2 rounded-xl font-semibold transition duration-300 bg-gray-300 text-gray-700"
          id="afterschool"
          data-type="Afterschool"
        >
          Afterschool
        </button>
      </div>

      <!-- Description Toggle -->
      <div class="flex items-center mb-8">
        <input
          type="checkbox"
          id="descriptionToggle"
          class="form-checkbox h-5 w-5 text-indigo-600"
        />
        <label for="descriptionToggle" class="ml-3 text-xl"
          >Include Description?</label
        >
      </div>

      <!-- Session Selection -->
      <h2 class="text-2xl font-semibold mb-4">Which Session?</h2>
      <select
        id="sessionField"
        class="w-full p-3 border rounded-xl mb-8 shadow-sm"
      >
        <option value="">All Sessions</option>
        <optgroup label="Winter">
          <option value="win2026-1">Winter</option>
        </optgroup>
        <optgroup label="Spring">
          <option value="2025%Spring%1">Spring (Session 1)</option>
          <option value="2025%Spring%2">Spring (Session 2)</option>
        </optgroup>
        <optgroup label="Summer">
          <option value="sum25-1">Summer (Session 1)</option>
          <option value="sum25-2">Summer (Session 2)</option>
        </optgroup>
        <optgroup label="Fall">
          <option value="fall25-1">Fall</option>
        </optgroup>
      </select>

      <!-- Sorting Selection -->
      <h2 class="text-2xl font-semibold mb-4">
        How would you like the results sorted?
      </h2>
      <select
        id="sortField"
        class="w-full p-3 border rounded-xl mb-8 shadow-sm"
      >
        <option value="StartDate">Start Date</option>
        <option value="Ages">Ages</option>
        <option value="Class">Class</option>
        <option value="Days">Days</option>
        <option value="Description">Description</option>
        <option value="Duration">Duration</option>
        <option value="EndDate">End Date</option>
        <option value="Openings">Openings</option>
        <option value="Session">Session</option>
        <option value="StartTime">Start Time</option>
        <option value="Tuition">Tuition</option>
      </select>

      <!-- Submit Button -->
      <button
        id="submit"
        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300"
      >
        Get Classes
      </button>
    </div>

    <!-- Results Container -->
    <div id="results" class="max-w-4xl w-full"></div>

    <script>
      let selectedClassType = "";

      // Toggle class type button active state
      document.querySelectorAll("#classTypeButtons .btn").forEach((button) => {
        button.addEventListener("click", () => {
          document.querySelectorAll("#classTypeButtons .btn").forEach((btn) => {
            btn.classList.remove("bg-indigo-600", "text-white");
            btn.classList.add("bg-gray-300", "text-gray-700");
          });
          button.classList.add("bg-indigo-600", "text-white");
          button.classList.remove("bg-gray-300", "text-gray-700");
          selectedClassType = button.getAttribute("data-type");
        });
      });

      // Handle form submission
      document.getElementById("submit").addEventListener("click", async () => {
        const sortBy = document.getElementById("sortField").value;
        const session = document.getElementById("sessionField").value;
        const includeDescription =
          document.getElementById("descriptionToggle").checked;
        const queryParams = new URLSearchParams({ OrgID: "554798" });
        if (selectedClassType) queryParams.append("Cat1", selectedClassType);
        if (sortBy) queryParams.append("sort", sortBy);
        if (session) queryParams.append("Session", session);
        if (includeDescription) queryParams.append("showcols", "Description");
        else queryParams.append("hidecols", "Description");

        const url = `https://app.jackrabbitclass.com/jr3.0/Openings/OpeningsJS?${queryParams.toString()}`;
        document.getElementById("submit").textContent = "Loading...";
        document.getElementById("submit").disabled = true;

        try {
          const response = await fetch(url);
          const data = await response.json(); // Assuming JSON response
          renderResults(data);
        } catch (error) {
          console.error("Error fetching data:", error);
          document.getElementById("results").innerHTML =
            '<p class="text-red-600">Error loading classes.</p>';
        }

        document.getElementById("submit").textContent = "Get Classes";
        document.getElementById("submit").disabled = false;
      });

      function renderResults(classes) {
        const container = document.getElementById("results");
        container.innerHTML = classes
          .map(
            (cls) => `
                <div class="bg-white shadow-md rounded-lg p-6 mb-6">
                    <h1 class="text-2xl font-bold text-gray-800">${
                      cls.name
                    }</h1>
                    <h2 class="text-lg text-gray-600">${cls.subtitle || ""}</h2>
                    <p><strong>Date:</strong> ${cls.date}</p>
                    <p><strong>Time:</strong> ${cls.time}</p>
                    <p><strong>Ages:</strong> ${cls.age}</p>
                    <p><strong>Instructor:</strong> ${cls.instructor}</p>
                    <p><strong>Price:</strong> ${cls.price}</p>
                    ${cls.description ? `<p>${cls.description}</p>` : ""}
                    <a href="${
                      cls.registerLink
                    }" class="mt-4 inline-block bg-indigo-600 text-white px-4 py-2 rounded">Register Now</a>
                </div>
            `
          )
          .join("");
      }
    </script>
  </body>
</html>
